CREATE OR REPLACE TRIGGER TRIGGER_2
BEFORE INSERT ON
TAPS_MOVIES
FOR EACH ROW
DECLARE
C1 CONTRACTS.STARTDATE%TYPE;
C2 CONTRACTS.ENDDATE%TYPE;
BEGIN
IF INSERTING THEN
  SELECT STARTDATE, ENDDATE INTO C1, C2
  FROM
  (
  SELECT
  CONTRACTID, STARTDATE, ENDDATE FROM
  CONTRACTS
  NATURAL JOIN
  TAPS_MOVIES
  WHERE(:NEW.VIEW_DATETIME=VIEW_DATETIME)
);
IF C1>TO_DATE(:NEW.VIEW_DATETIME) OR C2<TO_DATE(:NEW.VIEW_DATETIME) OR SYSDATE<TO_DATE(:NEW.VIEW_DATETIME)
THEN
RAISE_APPLICATION_ERROR(20001,'DATE IS NOT CORRECT');
END IF;
END IF;
END TRIGGER_2;
/
